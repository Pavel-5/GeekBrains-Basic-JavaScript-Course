При генерации каталога или корзины использовать замыкания в функциях, которые выполняются при опреденном событии.
Так как генерация каталога или корзины - отдельная функция, и к данным, находимся там, можно добраться только через функцию, на которую остается ссылка, а так как это обработчик события, то на неё всегда есть ссылка.
(событие прописано в той же функции генерации каталога или корзины).